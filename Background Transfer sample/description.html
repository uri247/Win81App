<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:sprite;/Areas/Epx/Themes/Windows/Content:0&amp;amp;hashKey=15EDE1F25211E852032D2691D5FEB7B8" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/9d0720cf-bf50-484c-bf6c-77cf57a10f7cCombined.css,0:sprite,1:LinkList;/Areas/Epx/Themes/Windows/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=52ADCBE5376E50AE6798D3D038D063E9" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Background Transfer sample</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" /><link href="description/f1d4cd5b-ee0e-41ab-9a4f-a8fc36768c28Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Background Transfer sample</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Windows Runtime
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Networking
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Windows RT
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">11/25/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/windowsapps/Background-Transfer-Sample-d7833f61">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="mainSection">
<p>This sample shows how to use the Background Transfer API to download and upload files in the background using in Windows Store apps.
</p>
<p>Classes in the <a href="http://msdn.microsoft.com/library/windows/apps/br207242">
<b>Windows.Networking.BackgroundTransfer</b></a> namespace provide a power-friendly, cost-aware, and flexible API for transferring files in the background. This sample shows how to use a number of features in the Background Transfer API.</p>
<p>For the download scenario, the sample first uses methods on <a href="http://msdn.microsoft.com/library/windows/apps/br207126">
<b>BackgroundDownloader</b></a> class to enumerate any downloads that were going on in the background while the app was closed. An app should enumerate these downloads when it gets started so it can attach a progress handler to these downloads to track progress
 and prevent stale downloads. Then other methods on the <b>BackgroundDownloader</b> and related classes are used to start new downloads to the local Pictures Library. The sample also shows how to pause downloads and change the priority of a download.
</p>
<p>For the upload scenario, the sample first uses methods on <a href="http://msdn.microsoft.com/library/windows/apps/br207140">
<b>BackgroundUploader</b></a> class to enumerate any uploads that were going on in the background while the app was closed. An app should enumerate these uploads when it gets started so it can attach a progress handler to these uploads to track progress and
 prevent stale uploads. Then other methods on the <b>BackgroundUploader</b> and related classes are used to start new uploads. The sample also shows how to set a content header and use a multipart upload.
</p>
<p>The sample also shows how to configure and use toast and tile notifications to inform the user when all transfers succeed or when at least one transfer fails.</p>
<p></p>
<p class="note"><b>Note</b>&nbsp;&nbsp;Background transfer is primarily designed for long-term transfer operations for resources like video, music, and large images. For short-term operations involving transfers of smaller resources (i.e. a few KB), the HTTP APIs are
 recommended. <a href="http://msdn.microsoft.com/library/windows/apps/dn298639"><b>HttpClient</b></a> is preferred and can be used in all languages supported by Windows Store apps.
<a href="http://msdn.microsoft.com/library/windows/apps/br229787"><b>XHR</b></a> can be used in JavaScript.
<a href="http://msdn.microsoft.com/library/windows/apps/hh770550">IXHR2</a> can be used in C&#43;&#43;.</p>
<p></p>
<p>This sample requires the following capabilities:</p>
<ul>
<li><b>Internet client</b> - Needed to send requests to download or upload files to HTTP or FTP servers on the Internet.
</li><li><b>Home or work networking</b> - Needed to send requests to download or upload files to HTTP or FTP servers on a home or work intranet.
</li><li><b>Pictures Library</b> - Needed to downloads files to the Pictures library. </li></ul>
<p class="note"><b>Note</b>&nbsp;&nbsp;Background Transfer is only enabled if at least one of the networking capabilities is set:
<b>Internet client</b>, <b>Internet (Client &amp; Server)</b>, or <b>Home or work networking</b>. For more information, see
<a href="http://msdn.microsoft.com/library/windows/apps/hh770532">How to configure network isolation capabilities</a>.</p>
<p></p>
<p>This sample is currently provided in the JavaScript, C#, VB, and C&#43;&#43; programming languages.</p>
<p>To obtain an evaluation copy of Windows&nbsp;8.1, go to <a href="http://go.microsoft.com/fwlink/p/?linkid=301696">
Windows&nbsp;8.1</a>.</p>
<p>To obtain an evaluation copy of Microsoft Visual Studio&nbsp;2013, go to <a href="http://go.microsoft.com/fwlink/p/?linkid=301697">
Visual Studio&nbsp;2013</a>.</p>
<p></p>
<p class="note"><b>Note</b>&nbsp;&nbsp;For Windows&nbsp;8 app samples, download the <a href="http://go.microsoft.com/fwlink/p/?LinkId=301698">
Windows&nbsp;8 app samples pack</a>. The samples in the Windows&nbsp;8 app samples pack will only build with Microsoft Visual Studio&nbsp;2012. The samples in the Windows&nbsp;8 app samples pack will only run on Windows&nbsp;8 and Windows Server&nbsp;2012.</p>
<p></p>
<h2><a id="related_topics"></a>Related topics</h2>
<dl><dt><b>Other resources</b> </dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/hh452752">Adding support for networking</a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/hh770532">How to configure network isolation capabilities</a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/hh700370">Quickstart: Downloading a file</a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/hh700372">Quickstart: Uploading a file</a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/hh761434">Transferring a file from a network resource</a>
</dt><dt><b>Reference</b> </dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/br207126"><b>BackgroundDownloader</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/br207140"><b>BackgroundUploader</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/dn298639"><b>HttpClient</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/hh770550">IXHR2</a> </dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/br207242"><b>Windows.Networking.BackgroundTransfer</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/br227346"><b>Windows.Storage</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/br229787"><b>XHR</b></a>
</dt><dt><b>Samples</b> </dt><dt><a href="http://go.microsoft.com/fwlink/p/?LinkID=227694">Windows 8 app samples</a>
</dt></dl>
<h2>Operating system requirements</h2>
<table>
<tbody>
<tr>
<th>Client</th>
<td><dt>Windows&nbsp;8.1 </dt></td>
</tr>
<tr>
<th>Server</th>
<td><dt>Windows Server&nbsp;2012&nbsp;R2 </dt></td>
</tr>
</tbody>
</table>
<h2>Build the sample</h2>
<p></p>
<ol>
<li>Start Visual Studio&nbsp;2013 and select <b>File</b> &gt; <b>Open</b> &gt; <b>Project/Solution</b>.
</li><li>Go to the directory in which you unzipped the sample. Go to the directory named for the sample, and double-click the Visual Studio&nbsp;2013 Solution (.sln) file.
</li><li>Press F7 or use <b>Build</b> &gt; <b>Build Solution</b> to build the sample. </li></ol>
<p></p>
<h2>Run the sample</h2>
<p>To debug the app and then run it, press F5 or use <b>Debug &gt; Start Debugging</b>. To run the app without debugging, press Ctrl&#43;F5 or use
<b>Debug &gt; Start Without Debugging</b>.</p>
<h2><a id="Set_up_the_localhost_server"></a><a id="set_up_the_localhost_server"></a><a id="SET_UP_THE_LOCALHOST_SERVER"></a>Set up the localhost server</h2>
<p>This sample requires that a web server is available for the app to access for uploading and downloading files. The web server must be started before the app is run. The sample includes a PowerShell script that will install IIS on the local computer, copy
 files to a web site path on the server, and set up a firewall rule to allow downloads and uploads.
</p>
<p>The easiest way to run the sample is to use the provided web server scripts. Browse to the
<i>Server</i> folder in your sample folder to setup and start the web server. There are two options possible.</p>
<p></p>
<ul>
<li>Start PowerShell elevated (Run as administrator) and run the following command:
<p><b>.\SetupServer.ps1</b></p>
<p>Note that you may also need to change script execution policy. </p>
</li><li>Start an elevated Command Prompt (Run as administrator) and run following command:
<p><b>PowerShell.exe -ExecutionPolicy Unrestricted -File SetupServer.ps1</b></p>
</li></ul>
<p></p>
<p>When the web server is not needed anymore, please browse to the <i>Server</i> folder in you sample folder and run one of the following:</p>
<p></p>
<ul>
<li>Start PowerShell elevated (Run as administrator) and run the following command:
<p><b>.\RemoveServer.ps1</b></p>
<p>Note that you may also need to change script execution policy. </p>
</li><li>Start an elevated Command Prompt (Run as administrator) and run following command:
<p><b>PowerShell.exe -ExecutionPolicy Unrestricted -File RemoveServer.ps1</b></p>
</li></ul>
<p></p>
<p class="note"><b>Note</b>&nbsp;&nbsp;IIS is not available on ARM builds. Instead, set up the web server on a separate 64-bit or 32-bit computer and follow the steps for using the sample against non-localhost web server.
</p>
<p class="note"><b>Note</b>&nbsp;&nbsp;When used with the supplied scripts, this Windows Store app sample communicates with another process (IIS server which is a desktop app) on the same machine over loopback for demonstration purposes only. A Windows Store app that
 communicates over loopback to another process that represents a Windows Store app is not allowed and such apps will not pass Store validation. For more information, see
<a href="http://msdn.microsoft.com/library/windows/apps/hh770532">How to configure network isolation capabilities</a>.
</p>
<h2><a id="Run_the_sample_against_custom_or_non-localhost_servers"></a><a id="run_the_sample_against_custom_or_non-localhost_servers"></a><a id="RUN_THE_SAMPLE_AGAINST_CUSTOM_OR_NON-LOCALHOST_SERVERS"></a>Run the sample against custom or non-localhost
 servers</h2>
<p>This sample can run against any server, not only the one provided with this sample. In this case, running one of the provided scripts as described in earlier steps is not required. However, the following should be taken into consideration when updating the
 sample to run against a custom or non-localhost server:</p>
<ul>
<li>The target URI field can be enabled by editing the existing xaml/html sample files. This will allow the target URI to be changed via the user interface.
</li><li>You need to copy files in the <i>cpp\Server\website</i> folder to the web server for downloading by the app.
</li></ul>
</div>

</div>


    </div>
</body>
</html>
